# 数组：为什么很多编程语言中数组都从0开始编号？

数组：一种**线性表**数据结构，他用一组**连续的内存空间**，来存储**相同类型**的数据。连续的内存空间和相同类型的数据让数组可以“随机访问”。

线性表结构：数组、链表、队列、栈（数据简单的前后关系）

非线性表：二叉树、堆、图等（数据之间不是简单的前后关系）



面试问题：数组和链表的区别？数组支持随机访问，根据下标随机访问的时间复杂度为O(1).

#### 低效的“插入”和“删除”

1. “插入操作”：将一个数据插入到数组第K个位置，要把k~n这部分元素后移，最好时间复杂度O(1)，最坏时间复杂度O(n)，平均时间复杂度：O(n)

   高级处理方式：将第K个位置的数据移到元素的最后，然后将数据插入地K个位置，时间复杂度O(1)

2. “删除操作”：删除数据的时候为了避免频繁的移动数据保持内存的连续性，每次删除数据的时候不是真正的删除数据，而是记录数据已被删除，当数组没有更多空间存储数据时，再触发一次真正的删除操作（标记清除算法）

#### 容器是否能完全替代数组？

容器的优势

1. 将很多数组操作的细节封装起来，比如插入、删除数据时需要搬移其他数据等
2. 支持动态扩容（存储空间不够，自动扩容为1.5倍大小，扩容操作涉及内存申请和数据搬移，最好能在创建的时候指定数据大小）

使用数组的场景

1. ArrayList无法存储基本类型，如int long 需要封装为Integer Long类，AutoBoxing、Unboxing有一定性能消耗，如果特别关注性能或者希望使用基本类型可以选用数组
2. 如果数据大小事先已知，且对数据的操作非常简单
3. 多维的情况，数组会更加的直观[][] `ArrayList<ArrayList<object>>`

总结：业务开发直接使用容器，如果做底层开发要把性能做到极致的话数组会成为首选



#### 为什么大多数编程语言中，数组要从 0 开始编号？

1、从数组存储的内存模型上来看，“下标”最确切的定义应该是“偏移（offset）”，a[0]就是偏移为 0 的位置，也就是首地址，a[k]就表示偏移 k 个 type_size 的位置

从0开始编号：a[k]_address = base_address + k * type_size
从1开始编号：a[k]_address = base_address + (k-1)*type_size

多了1次减法操作



#### 标记清除算法

JVM标记清除算法：大多数主流虚拟机采用可达性分析算法来判断对象是否存活，在标记阶段，会遍历所有 GC ROOTS，将所有 GC ROOTS 可达的对象标记为存活，只有当标记工作完成后，清理工作才会开始。

不足：

- 效率问题：标记和清理效率都不高，但是当知道只有少量垃圾产生时会很高效。
- 空间问题：会产生不连续的内存空间碎片。



#### 二维数组内存寻址

对于 m * n 的数组，a [ i ][ j ] (i < m,j < n)的地址为： address = base_address + ( i * n + j) * type_size



#### 数组越界

对于数组访问越界造成无限循环，我理解是编译器的问题，对于不同的编译器，在内存分配时，会按照内存地址递增或递减的方式进行分配。老师的程序，如果是内存地址递减的方式，就会造成无限循环。





